From b759ed766dae12b59e1ced0baec16b08b7590921 Mon Sep 17 00:00:00 2001
From: Suraj Jitindar Singh <surajjs@amazon.com>
Date: Fri, 15 Oct 2021 13:56:40 -0700
Subject: ARM64: kvm: vgic-v3-sr: Bug when trying to read invalid APRs

There are 4 interrupt controller active priorities group [0-1] registers which
are read through __vgic_v3_read_ap0rn() and __vgic_v3_read_ap1rn(). When these
functions are passed an argument which isn't 0-3 they fall through to what ever
happens to be after them in memory. To avoid this BUG() in the case where an
invalid argument is passed.

Signed-off-by: Suraj Jitindar Singh <surajjs@amazon.com>
---
 arch/arm64/kvm/hyp/vgic-v3-sr.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/kvm/hyp/vgic-v3-sr.c b/arch/arm64/kvm/hyp/vgic-v3-sr.c
index 452f4cacd674..b47aac452fe1 100644
--- a/arch/arm64/kvm/hyp/vgic-v3-sr.c
+++ b/arch/arm64/kvm/hyp/vgic-v3-sr.c
@@ -164,7 +164,7 @@ static u32 __vgic_v3_read_ap0rn(int n)
 		val = read_gicreg(ICH_AP0R3_EL2);
 		break;
 	default:
-		unreachable();
+		BUG();
 	}
 
 	return val;
@@ -188,7 +188,7 @@ static u32 __vgic_v3_read_ap1rn(int n)
 		val = read_gicreg(ICH_AP1R3_EL2);
 		break;
 	default:
-		unreachable();
+		BUG();
 	}
 
 	return val;
-- 
2.32.0

